os: windows
language: cpp

branches:
  only:
  - master

script:
  - mkdir build
  - cd build && cmake .. && cmake --build . && ./Debug/test-main.exe
  - cmake --build . --target zip

before_deploy:
  # Set up git user name and tag this commit
  - git config --local user.name "Anton Voloshin"
  - git config --local user.email "ashutosh108@gmail.com"
  - export TRAVIS_TAG=${TRAVIS_TAG:-preview-$(date +'%Y-%m-%d')}
  - git tag $TRAVIS_TAG || true

deploy:
  provider: releases
  api_key:
    secure: rqxAmd5/loEIr4QGekmXccanzwcjqlYaf4Ad1kcTDAQhgxEiUPG3TVGeYuUjIkRpdVC4ukxWpcDUWOt5hRkVJGPr1JmOVU7FaF3bc0WQoOGojljGOpLypHo7Xh+lcFXHm+TzEzbyErJvJqNhgdm4r8cBDEHkPhn51Lt2e+DyIXxPR8SlOUEaATnBIzycXae+3EymgHWuvtuRWXO1yPcu+F1vITRgfZnm9rBDczYbyOjJ0quHSSAQBMAr1ITUnK51moro0DDsjM0AplxTK/j4WOa5RoynaQg89j427eNHXcHD6aQYO0ls7FlvDLxn9gas/wnz6YC4mfg5LAvtQF4peNbnh2cjN/USWR1bpEfIbZAtxg5xToT9Wn2MdjuBlQOWKsGAx4RjZPoY2d1am0vhi1aHnA39Mx+nEKzFRHAIqB49PvH6Jo6L/3BdPBAIw0yUsQ7+vTu7/gYl0QHCMaef3fkf0WEBlRuLYHhR57UGAp9P76jMFcUU0s5dRZZs9DtKdOWfel/Qw6EZvZcoNuMESsPbzydS3A90to5c+fl6GST7KGDtJI0xIxCVbRl2y/0+aa87HVtGHV0UPqdeWgJEb8lXfFnuH6hZlh71wz1O0FdmwSTIl15MTKojJt9InUeyX4lSZ7PPeeIubdsne3UBV2paF+qUUt7EUZBjJa1Q5LM=
  file: vaishnavam-panchangam.zip
  skip_cleanup: true
  overwrite: true
  prerelease: true
  on:
    repo: ashutosh108/vaishnavam-panchangam
